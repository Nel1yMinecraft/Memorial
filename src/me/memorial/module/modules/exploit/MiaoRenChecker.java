package me.memorial.module.modules.exploit;

import me.memorial.events.EventTarget;
import me.memorial.events.impl.player.UpdateEvent;
import me.memorial.module.Module;
import me.memorial.module.ModuleCategory;
import me.memorial.module.ModuleInfo;
import me.memorial.utils.ClientUtils;
import me.memorial.utils.timer.MSTimer;
import me.memorial.utils.timer.TimeUtils;
import me.memorial.value.IntegerValue;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.item.Item;
import net.minecraft.item.ItemAxe;

import java.util.HashSet;
import java.util.Set;

@ModuleInfo(name = "MiaoRenChecker", description = "", category = ModuleCategory.EXPLOIT)
public class MiaoRenChecker extends Module {
    private IntegerValue DelayValue = new IntegerValue("Delay", 1000, 0, 10000);

    private MSTimer msTimer = new MSTimer();
    private int delay = (int) TimeUtils.randomDelay(DelayValue.get(), DelayValue.get());
    private Set<String> detectedPlayers = new HashSet<>();

    @EventTarget
    public void onUpdate(UpdateEvent event) {
        for (EntityPlayer player : mc.theWorld.playerEntities) {
            if (player.getHeldItem() != null && player.getHeldItem().getItem() instanceof ItemAxe && ((ItemAxe) player.getHeldItem().getItem()).getToolMaterialName().equals(Item.ToolMaterial.GOLD.toString()) && player.getHeldItem().getItemDamage() >= 25 && !detectedPlayers.contains(player.getName())) {
                detectedPlayers.add(player.getName());
                ClientUtils.displayChatMessage("§7[§8§lMemorial§7]§f:" + player.getName() + "§c拿着秒人斧");//不是 我他妈惹你了。？ 我他妈自己写的秒人斧检测 怎么在这么多傻逼花雨庭内部手上 我真想操死你们妈妈
            }
        }

        if (msTimer.hasTimePassed(delay)) {
            msTimer.reset();
            detectedPlayers.clear();
        }
    }
}
